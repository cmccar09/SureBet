START RequestId: bf8ac8d3-4338-4099-8fef-1f7966cf6b4c Version: $LATEST
Lambda execution started
Loading learning insights...
S3 insights not available: An error occurred (AccessDenied) when calling the GetObject operation: User: arn:aws:sts::813281204422:assumed-role/betting-eu-role/betting is not authorized to perform: s3:ListBucket on resource: "arn:aws:s3:::betting-insights" because no identity-based policy allows the s3:ListBucket action
DynamoDB insights not available: An error occurred (ValidationException) when calling the GetItem operation: The provided key element does not match the schema
ℹ️ No learning insights yet (system still building track record)
Fetching Betfair odds...
Fetching live Betfair odds (UK/IRE horse racing)...
Fetching Betfair session from Secrets Manager...
Fetching UK/IRE horse racing markets...
Error fetching Betfair markets: 400 Client Error: Bad Request for url: https://api.betfair.com/exchange/betting/rest/v1.0/listMarketCatalogue/
Betfair fetch failed: 400 Client Error: Bad Request for url: https://api.betfair.com/exchange/betting/rest/v1.0/listMarketCatalogue/, using mock data as fallback...
Using realistic mock data (Betfair geo-restricted from AWS)
Found 3 races
Calling Claude AI...
Initial parse failed, extracting JSON from text: Expecting value: line 1 column 1 (char 0)
Extracted JSON successfully: 5 bets
Claude returned 5 predictions
Storing bets in DynamoDB...
=== STORING 5 BETS ===
Races data available: 3 races
Processing bet: Mighty Runner at Cheltenham
=== MATCHING: Mighty Runner at Cheltenham ===
Looking for race_time: 2026-01-08T17:44:32Z
Total races to search: 3
Normalized race_time: 2026-01-08T17:44:32
Horse name (lower): 'mighty runner'
Race 1: Leopardstown @ 2026-01-08T17:29:32Z (market: 1.234567)
Course match: False ('Leopardstown' vs 'Cheltenham')
Time match: False ('2026-01-08T17:29' vs '2026-01-08T17:44')
Race 2: Cheltenham @ 2026-01-08T17:44:32Z (market: 1.234568)
Course match: True ('Cheltenham' vs 'Cheltenham')
Time match: True ('2026-01-08T17:44' vs '2026-01-08T17:44')
✓ Race matched! Searching 8 runners...
✓✓ MATCHED! Mighty Runner -> selection_id: 10102
Result: market_id=1.234568, selection_id=10102
ERROR: An error occurred (ValidationException) when calling the PutItem operation: One or more parameter values were invalid: Missing the key bet_date in the item
Traceback (most recent call last):
File "/var/task/lambda_function.py", line 477, in lambda_handler
store_bets_in_dynamodb(bets, prompt, bets, races)
File "/var/task/lambda_function.py", line 390, in store_bets_in_dynamodb
table.put_item(Item=item)
File "/var/task/boto3/resources/factory.py", line 581, in do_action
response = action(self, *args, **kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "/var/task/boto3/resources/action.py", line 88, in __call__
response = getattr(parent.meta.client, operation_name)(*args, **params)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "/var/task/botocore/client.py", line 602, in _api_call
return self._make_api_call(operation_name, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "/var/task/botocore/context.py", line 123, in wrapper
return func(*args, **kwargs)
^^^^^^^^^^^^^^^^^^^^^
File "/var/task/botocore/client.py", line 1078, in _make_api_call
raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (ValidationException) when calling the PutItem operation: One or more parameter values were invalid: Missing the key bet_date in the item
END RequestId: bf8ac8d3-4338-4099-8fef-1f7966cf6b4c
REPORT RequestId: bf8ac8d3-4338-4099-8fef-1f7966cf6b4c	Duration: 11476.06 ms	Billed Duration: 12499 ms	Memory Size: 512 MB	Max Memory Used: 97 MB	Init Duration: 1022.83 ms	

